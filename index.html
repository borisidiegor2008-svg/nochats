<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RED_VOID // ANONYMOUS_CHAT</title>
    <script src="https://cdn.ably.com/lib/ably.min-1.js"></script>
    <style>
        :root {
            --primary: #ff0000;
            --bg-dark: #0a0000;
            --bg-panel: #1a0000;
            --text-glow: 0 0 12px rgba(255, 0, 0, 0.8);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Courier New', monospace; }

        body {
            background-color: var(--bg-dark);
            color: var(--primary);
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        #matrix-bg {
            position: fixed;
            top: 0; left: 0; z-index: -1;
            opacity: 0.2;
        }

        header {
            padding: 15px;
            background: var(--bg-panel);
            border-bottom: 2px solid var(--primary);
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: var(--text-glow);
        }

        #chat-container {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 12px;
            scrollbar-width: thin;
            scrollbar-color: var(--primary) transparent;
        }

        .message {
            background: rgba(30, 0, 0, 0.7);
            padding: 12px;
            border: 1px solid rgba(255, 0, 0, 0.3);
            border-left: 4px solid var(--primary);
            max-width: 85%;
            animation: glitch 0.2s ease;
            word-wrap: break-word;
        }

        .meta { font-size: 0.75rem; margin-bottom: 6px; color: #ff5555; font-weight: bold; }

        .input-area {
            background: var(--bg-panel);
            padding: 15px;
            border-top: 2px solid var(--primary);
            display: flex;
            gap: 10px;
        }

        input {
            flex: 1;
            background: #000;
            border: 1px solid var(--primary);
            color: var(--primary);
            padding: 12px;
            outline: none;
            box-shadow: inset 0 0 5px rgba(255,0,0,0.2);
        }

        button {
            background: var(--primary);
            color: #000;
            border: none;
            padding: 0 25px;
            font-weight: bold;
            cursor: pointer;
            text-transform: uppercase;
        }

        button:active { transform: scale(0.95); }

        @keyframes glitch {
            0% { transform: skew(5deg); opacity: 0; }
            100% { transform: skew(0deg); opacity: 1; }
        }

        /* Mobile */
        @media (max-width: 600px) {
            .message { max-width: 100%; }
            header h1 { font-size: 1rem; }
        }
    </style>
</head>
<body>

<canvas id="matrix-bg"></canvas>

<header>
    <div>
        <h1>[ RED_VOID_NETWORK ]</h1>
        <div class="meta">ğŸ•¶ï¸ ANON-ID: <span id="anon-id">...</span></div>
    </div>
    <div id="connection-status" style="font-size: 0.7rem; color: #555;">CONNECTING...</div>
</header>

<div id="chat-container"></div>

<div class="input-area">
    <input type="text" id="msg-input" placeholder="ACCESS DATA LINE..." maxlength="500">
    <button id="send-btn">SEND</button>
</div>

<script>
    // --- ĞĞĞ¡Ğ¢Ğ ĞĞ™ĞšĞ˜ ---
    // Ğ’ÑÑ‚Ğ°Ğ²ÑŒÑ‚Ğµ Ğ²Ğ°Ñˆ ĞºĞ»ÑÑ‡ ÑÑĞ´Ğ°, Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Ñ‡Ğ°Ñ‚ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ğ» Ğ¼ĞµĞ¶Ğ´Ñƒ Ñ€Ğ°Ğ·Ğ½Ñ‹Ğ¼Ğ¸ ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ°Ğ¼Ğ¸!
    const API_KEY = 'jDgMYA.joglYA:ZnmgoLWpNmiUUn_lV0WrZ5hsOOx8rYk4Yc2wJ2qXi3U'; 
    const CHANNEL_NAME = 'global-anonymous-chat';
    
    const ANON_ID = 'X-' + Math.random().toString(36).substr(2, 5).toUpperCase();
    document.getElementById('anon-id').innerText = ANON_ID;

    // --- Ğ˜ĞĞ˜Ğ¦Ğ˜ĞĞ›Ğ˜Ğ—ĞĞ¦Ğ˜Ğ¯ Ğ¡Ğ•Ğ¢Ğ˜ ---
    let channel;
    if (API_KEY === 'Ğ’ĞĞ¨_ABLY_API_KEY') {
        alert("ĞĞ¨Ğ˜Ğ‘ĞšĞ: ĞÑƒĞ¶Ğ½Ğ¾ Ğ²ÑÑ‚Ğ°Ğ²Ğ¸Ñ‚ÑŒ API_KEY Ğ¸Ğ· ably.com Ğ² ĞºĞ¾Ğ´, Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ Ğ»ĞµÑ‚Ğ°Ğ»Ğ¸ Ğ¼ĞµĞ¶Ğ´Ñƒ ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ°Ğ¼Ğ¸.");
    } else {
        const ably = new Ably.Realtime(API_KEY);
        channel = ably.channels.get(CHANNEL_NAME);

        ably.connection.on('connected', () => {
            document.getElementById('connection-status').innerText = 'ğŸ”´ ONLINE';
            document.getElementById('connection-status').style.color = 'red';
        });

        // Ğ¡Ğ›Ğ£Ğ¨ĞĞ•Ğœ Ğ¡ĞĞĞ‘Ğ©Ğ•ĞĞ˜Ğ¯ (Ñ‚ÑƒÑ‚ Ğ¾Ğ½Ğ¸ Ğ¿Ñ€Ğ¸Ğ»ĞµÑ‚Ğ°ÑÑ‚ Ñ Ğ´Ñ€ÑƒĞ³Ğ¸Ñ… ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²)
        channel.subscribe('msg', (message) => {
            renderMessage(message.data.sender, message.data.text);
        });
    }

    // --- Ğ¤Ğ£ĞĞšĞ¦Ğ˜Ğ˜ ---
    function renderMessage(sender, text) {
        const container = document.getElementById('chat-container');
        const time = new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
        const msgDiv = document.createElement('div');
        msgDiv.className = 'message';
        msgDiv.innerHTML = `
            <div class="meta">${sender === ANON_ID ? 'YOU' : 'ğŸ•¶ï¸ ' + sender} // ${time}</div>
            <div class="content">${escapeHTML(text)}</div>
        `;
        container.appendChild(msgDiv);
        container.scrollTop = container.scrollHeight;
    }

    function escapeHTML(str) {
        return str.replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]));
    }

    let lastSend = 0;
    async function sendMessage() {
        const input = document.getElementById('msg-input');
        const text = input.value.trim();
        const now = Date.now();

        if (!text || !channel) return;

        // ĞĞĞ¢Ğ˜-Ğ¡ĞŸĞĞœ (2 ÑĞµĞºÑƒĞ½Ğ´Ñ‹)
        if (now - lastSend < 2000) {
            alert("SYSTEM ERROR: TOO MANY REQUESTS");
            return;
        }

        // ĞĞ¢ĞŸĞ ĞĞ’Ğ›Ğ¯Ğ•Ğœ Ğ’ Ğ¡Ğ•Ğ¢Ğ¬
        channel.publish('msg', { sender: ANON_ID, text: text });
        
        input.value = '';
        lastSend = now;
    }

    document.getElementById('send-btn').onclick = sendMessage;
    document.getElementById('msg-input').onkeypress = (e) => { if(e.key === 'Enter') sendMessage(); };

    // --- MATRIX EFFECT ---
    const canvas = document.getElementById('matrix-bg');
    const ctx = canvas.getContext('2d');
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    const chars = "ï½¦ï½±ï½³ï½´ï½µï½¶ï½·ï½¸ï½¹ï½ºï½»ï½¼ï½½ï½¾ï½¿ï¾€ï¾ï¾‚ï¾ƒï¾„ï¾…ï¾†ï¾‡ï¾ˆï¾‰ï¾Šï¾‹ï¾Œï¾ï¾ï¾ï¾ï¾‘ï¾’ï¾“ï¾”ï¾•ï¾–ï¾—ï¾˜ï¾™ï¾šï¾›ï¾œï¾23456789";
    const fontSize = 16;
    const columns = canvas.width / fontSize;
    const drops = Array(Math.floor(columns)).fill(1);

    function draw() {
        ctx.fillStyle = "rgba(0, 0, 0, 0.05)";
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        ctx.fillStyle = "#f00";
        ctx.font = fontSize + "px monospace";
        for (let i = 0; i < drops.length; i++) {
            const text = chars.charAt(Math.floor(Math.random() * chars.length));
            ctx.fillText(text, i * fontSize, drops[i] * fontSize);
            if (drops[i] * fontSize > canvas.height && Math.random() > 0.975) drops[i] = 0;
            drops[i]++;
        }
    }
    setInterval(draw, 40);
</script>
</body>
</html>
